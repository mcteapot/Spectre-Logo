#target illustrator// FUNCTIONS //var clearSelections = function(sourceFontTemplateDocument) {    if(sourceFontTemplateDocument.selection.length > 0) {        while(sourceFontTemplateDocument.selection.length != 0) {            var selectionLen = sourceFontTemplateDocument.selection.length - 1;            //$.writeln(selectionLen); // DEBUG            sourceFontTemplateDocument.selection[selectionLen].selected = false;        }    }         }var setActive = function(sourceDocument) {    activeDocument = sourceDocument;}var copyAllUnlockedLayers = function(sourceDocument, ouputDocumet) {    //cycle threw layers     var totalLayers = sourceDocument.layers.length;    for(var i = 0; totalLayers > i; i++) {        var layerName = sourceDocument.layers[i].name;            //alert(layerName);        if(sourceDocument.layers[i].locked === false) {            clearSelections(sourceDocument);            sourceDocument.layers[i].hasSelectedArtwork = true;            app.copy();            setActive(ouputDocumet);            var newLayer = ouputDocumet.layers.add()            newLayer.name =  layerName;            app.paste();            setActive(sourceDocument);                            //$.writeln(layerName); // DEBUG            //$.writeln(sourceDocument.layers[i].pathItems.length); // DEBUG            //$.writeln(sourceDocument.layers[i].groupItems.length); // DEBUG                }            }}var relizeAllLayers = function(sourceDocument) {    //set to active document    activeDocument = sourceDocument;        var totalLayers = sourceDocument.layers.length;    var resizeFont = 100.0 * 17.5;    var positionLanding = Array(364, 300);    // rest acording to font baseline    var positionBaseLine = Array(-284, 884);    // rest according to path    var pathToDel = "background_dont_rename"    //move threw all layers    for(var i = 0; totalLayers > i; i++) {        //if layer is not locked         if(sourceDocument.layers[i].locked === false) {             //get layer name and groupItems             var layerName = sourceDocument.layers[i].name;             //$.writeln(pathItmesLength); // DEBUG             var groupItemsLength = sourceDocument.layers[i].groupItems.length;             var documentLayers = sourceDocument.layers;             //if group itmes             if(groupItemsLength >= 1) {                 //resiae fonts                 documentLayers[i].groupItems[0].position = positionLanding;                 documentLayers[i].groupItems[0].resize(resizeFont, resizeFont);                 documentLayers[i].groupItems[0].position = positionBaseLine;                 var pathItmesLength = documentLayers[i].groupItems[0].pathItems.length;                 //delete background, make sure to                  if(pathItmesLength >= 1) {                    //$.writeln(pathItmesLength); // DEBUG                    for(var j = 0; pathItmesLength > j; j++) {                        var pathName = documentLayers[i].groupItems[0].pathItems[j].name;                        //$.writeln(pathName); // DEBUG                        if(pathName === pathToDel) {                            pathRemove = i;                            documentLayers[i].groupItems[0].pathItems[j].remove();                            break;                        }                    }                 }             }                                              //$.writeln(groupItemsLength); // DEBUG            //$.writeln(layerName); // DEBUG                      }            }}var copyToFoltLab = function(sourceDocument) {    //set to active document    activeDocument = sourceDocument;    //var layerName = "ARJUN"    //alert('Paste letter: "' + layerName + '" into FontLab')         //cycle threw layers     var totalLayers = sourceDocument.layers.length;    for(var i = 0; totalLayers > i; i++) {        var layerName = sourceDocument.layers[i].name;            //alert(layerName);        if(sourceDocument.layers[i].locked === false) {            clearSelections(sourceDocument);            sourceDocument.layers[i].hasSelectedArtwork = true;            app.copy();            alert('Paste letter: "' + layerName + '" into FontLab')                         //$.writeln(layerName); // DEBUG            //$.writeln(sourceDocument.layers[i].pathItems.length); // DEBUG            //$.writeln(sourceDocument.layers[i].groupItems.length); // DEBUG                }            } }// MAIN //if(activeDocument.name === "font_template.ai") {    //global vars    var sourceFontTemplateDocument = activeDocument;    var outputFontTemplateFilePath = sourceFontTemplateDocument.path + "/output_template.ai";    var outputFontTemplateFile = new File(outputFontTemplateFilePath);    //clear all selections    clearSelections (sourceFontTemplateDocument);    app.open(outputFontTemplateFile);    var outputFontTemplateDocument = activeDocument;    setActive(sourceFontTemplateDocument);        //cycle threw layers and copy function    copyAllUnlockedLayers(sourceFontTemplateDocument, outputFontTemplateDocument);    relizeAllLayers(outputFontTemplateDocument);    setActive(sourceFontTemplateDocument);    copyToFoltLab(outputFontTemplateDocument);    setActive(sourceFontTemplateDocument);    //setActive(outputFontTemplateDocument);} else {    //wrong file    alert("wrong file. please run script with file: font_template.ai ", "Errior!", false);}